{% extends "base.html" %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="website-gradient-card p-4 mb-5">
            <div class="analysis-container">
                <h2 class="mb-4 text-center animate__animated animate__fadeIn">Website Phishing Analysis</h2>
                <form method="POST" class="animate__animated animate__fadeInUp">
                    <div class="mb-3">
                        <label for="url" class="form-label">Website URL:</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="fas fa-globe"></i></span>
                            <input type="url" class="form-control" id="url" name="url" 
                                   value="{{ url if url else '' }}" placeholder="https://example.com" required>
                        </div>
                    </div>
                    <div class="text-center">
                        <button type="submit" class="btn btn-primary btn-lg">
                            <i class="fas fa-shield-alt me-2"></i>Analyze Website
                        </button>
                    </div>
                </form>
                {% if result %}
                <div class="mt-5 animate__animated animate__fadeIn">
                    <h3 class="text-center mb-4">Analysis Results</h3>
                    <div class="card mb-3 shadow-lg">
                        <div class="card-header">
                            <h5 class="mb-0">Phishing Likelihood: 
                                <span class="badge 
                                    {% if result.likelihood == 'High' %}bg-danger
                                    {% elif result.likelihood == 'Medium' %}bg-warning text-dark
                                    {% elif result.likelihood == 'Low' %}bg-info text-dark
                                    {% else %}bg-secondary{% endif %} animate__animated animate__pulse">
                                    {{ result.likelihood }}
                                </span>
                                <div class="progress">
                                    <div class="progress-bar 
                                        {% if result.likelihood == 'High' %}bg-danger
                                        {% elif result.likelihood == 'Medium' %}bg-warning
                                        {% elif result.likelihood == 'Low' %}bg-info
                                        {% else %}bg-secondary{% endif %}"
                                        role="progressbar" 
                                        style="width: {{ result.score }}%;" 
                                        aria-valuenow="{{ result.score }}" 
                                        aria-valuemin="0" 
                                        aria-valuemax="100">
                                    </div>
                                </div>
                                <small class="text-muted">Score: {{ result.score }}/100</small>
                            </h5>
                        </div>
                        <div class="card-body">
                            {% if result.suspicious_domain %}
                            <div class="alert alert-danger animate__animated animate__shakeX">
                                <i class="fas fa-exclamation-triangle me-2"></i>
                                <strong>Suspicious Domain:</strong> This domain is known for phishing or looks similar to known phishing domains.
                            </div>
                            {% endif %}
                            <div class="alert alert-secondary animate__animated animate__fadeIn">
                                <i class="fas fa-link me-2"></i>
                                <strong>Connection to Known Phishing Sites:</strong> 
                                {% if result.has_connection %}
                                    {% if result.connection_hops == 0 %}
                                    <span class="text-danger">Direct match with a known phishing site.</span>
                                    {% else %}
                                    <span class="text-warning">{{ result.connection_hops }} hop(s) from a known phishing site.</span>
                                    {% endif %}
                                {% else %}
                                <span class="text-success">No connection to known phishing sites.</span>
                                {% endif %}
                            </div>
                            {% if result.security_issues %}
                            <div class="alert alert-warning animate__animated animate__fadeIn">
                                <i class="fas fa-shield-alt me-2"></i>
                                <strong>Security Issues Detected:</strong>
                                <ul class="security-issues-list mb-0 mt-2">
                                    {% for issue in result.security_issues %}
                                    <li>{{ issue }}</li>
                                    {% endfor %}
                                </ul>
                            </div>
                            {% endif %}
                            {% if result.domain_analysis %}
                            <div class="alert alert-info animate__animated animate__fadeIn">
                                <i class="fas fa-search me-2"></i>
                                <strong>Domain Analysis:</strong>
                                <div class="row mt-3">
                                    <div class="col-md-6">
                                        <div class="domain-card">
                                            <h6 class="card-title">Domain Information</h6>
                                            <p class="mb-1"><strong>Domain:</strong> {{ result.domain_analysis.domain }}</p>
                                            {% if result.domain_analysis.subdomain %}
                                            <p class="mb-1"><strong>Subdomain:</strong> {{ result.domain_analysis.subdomain }}</p>
                                            {% endif %}
                                            <p class="mb-1"><strong>TLD:</strong> {{ result.domain_analysis.tld }}</p>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="domain-card">
                                            <h6 class="card-title">Security Status</h6>
                                            {% if result.domain_analysis.is_ip %}
                                            <p class="mb-1 text-danger"><i class="fas fa-exclamation-circle"></i> Domain is an IP address</p>
                                            {% else %}
                                            <p class="mb-1 text-success"><i class="fas fa-check-circle"></i> Valid domain name</p>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<style>
.website-gradient-card {
    background: radial-gradient(circle at 50% 50%, #f5fafd 0%, #e0eafc 40%, #b0c4de 100%);
    border-radius: 24px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.10);
}
.analysis-container {
    padding: 30px;
    border-radius: 20px;
    background: rgba(255, 255, 255, 0.97);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.12);
}
.domain-card {
    background: #fff;
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 15px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
    color: #222;
}
.security-issues-list li {
    color: #333;
    background: #f8f9fa;
    border-left: 4px solid #3498db;
    margin-bottom: 8px;
    border-radius: 6px;
    padding: 8px 12px;
    animation: slideIn 0.5s ease-out forwards;
    opacity: 0;
    animation-fill-mode: forwards;
}
.security-issues-list li:nth-child(1) { animation-delay: 0.05s; }
.security-issues-list li:nth-child(2) { animation-delay: 0.1s; }
.security-issues-list li:nth-child(3) { animation-delay: 0.15s; }
.security-issues-list li:nth-child(4) { animation-delay: 0.2s; }
.security-issues-list li:nth-child(5) { animation-delay: 0.25s; }
.btn-primary {
    background: linear-gradient(135deg, #3498db, #2980b9);
    border: none;
    padding: 12px 35px;
    border-radius: 30px;
    font-weight: 600;
    letter-spacing: 0.5px;
    transition: all 0.3s ease;
}
.btn-primary:hover {
    transform: scale(1.05);
    box-shadow: 0 8px 25px rgba(52, 152, 219, 0.4);
}
.input-group-text {
    background: #f8f9fa;
    border: none;
    padding: 15px 20px;
}
.form-control {
    border: none;
    padding: 15px 20px;
    font-size: 16px;
}
.form-control:focus {
    box-shadow: none;
    border-color: #3498db;
}
@keyframes slideIn {
    from { transform: translateX(-100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
}
</style>

<!-- Add Font Awesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
<!-- Add Animate.css for animations -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
{% endblock %}